<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Firebase Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>Simple Firebase Test</h1>
    <div id="results"></div>

    <!-- Load Firebase scripts -->
    <script src="firebase-config.js"></script>
    <script src="firestore-game-data.js"></script>

    <script>
        function addResult(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = message;
            results.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        // Wait for Firebase to be ready
        async function waitForFirebaseReady() {
            let attempts = 0;
            const maxAttempts = 50; // 5 seconds max wait
            
            while (attempts < maxAttempts) {
                if (window.firebaseConfig && window.firebaseDb && window.GameDataManager && window.collection) {
                    return true;
                }
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }
            return false;
        }

        // Test Firebase availability
        async function testFirebaseAvailability() {
            addResult('Scripts loaded, waiting for Firebase to be ready...', 'info');
            
            const firebaseReady = await waitForFirebaseReady();
            if (!firebaseReady) {
                addResult('❌ Firebase initialization timeout!', 'error');
                return;
            }

            addResult('✅ Firebase is ready, testing components...', 'success');

            // Test 1: Check if firebaseConfig is available
            if (typeof window.firebaseConfig !== 'undefined') {
                addResult('✅ firebaseConfig found', 'success');
                addResult(`Project ID: ${window.firebaseConfig.projectId}`, 'info');
            } else {
                addResult('❌ firebaseConfig not found', 'error');
            }

            // Test 2: Check if firebaseDb is available
            if (typeof window.firebaseDb !== 'undefined') {
                addResult('✅ firebaseDb found', 'success');
            } else {
                addResult('❌ firebaseDb not found', 'error');
            }

            // Test 3: Check if GameDataManager is available
            if (typeof window.GameDataManager !== 'undefined') {
                addResult('✅ GameDataManager found', 'success');
            } else {
                addResult('❌ GameDataManager not found', 'error');
            }

            // Test 4: Check Firebase functions
            const requiredFunctions = ['collection', 'query', 'getDocs', 'orderBy', 'limit', 'where'];
            const missingFunctions = requiredFunctions.filter(func => typeof window[func] === 'undefined');
            
            if (missingFunctions.length === 0) {
                addResult('✅ All Firebase functions available', 'success');
            } else {
                addResult(`❌ Missing Firebase functions: ${missingFunctions.join(', ')}`, 'error');
            }
        }

        // Run tests when page loads
        window.addEventListener('load', testFirebaseAvailability);
    </script>
</body>
</html>