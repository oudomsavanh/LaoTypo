<!DOCTYPE html>
<html lang="lo">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading Screen Integration Example - Lao Typo Game</title>
    
    <!-- CRITICAL: Load these in the head for instant splash screen -->
    <link rel="stylesheet" href="/loading-screen.css">
    
    <!-- Preload critical assets -->
    <link rel="preload" href="/images/LaoTypo-logo-04.png" as="image">
    <link rel="preload" href="/images/Gecko.png" as="image">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <style>
        /* Inline critical CSS for instant render */
        body {
            margin: 0;
            padding: 0;
            background-color: #2c2e31;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        /* Hide main content until loaded */
        #main-content {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }
        
        #main-content.ready {
            display: block;
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Loading Screen (renders immediately) -->
    <div id="loadingScreen" class="loading-screen">
        <div class="splash-container">
            <img src="/images/LaoTypo-logo-04.png" alt="LaoTypo" class="loading-logo" />
            <h1 class="loading-title">‡ªÄ‡∫Å‡∫°‡∫û‡∫¥‡∫°‡∫•‡∫≤‡∫ß</h1>
            <p class="loading-subtitle">‡ªÄ‡∫à‡∫ª‡ªâ‡∫≤‡ªÅ‡∫°‡ªà‡∫ô‡∫Ñ‡∫ª‡∫ô‡∫•‡∫≤‡∫ß‡∫à‡∫£‡∫¥‡∫á ‡∫´‡∫º‡∫∑ ‡∫•‡∫≤‡∫ß‡∫≠‡∫µ‡ªà‡∫´‡∫•‡∫µ?</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
            <div class="progress-text">
                <span>‡∫Å‡∫≥‡∫•‡∫±‡∫á‡ªÇ‡∫´‡∫º‡∫î...</span>
                <span id="progressPercentage" class="progress-percentage">0%</span>
            </div>
            <div id="progressMessage" class="progress-message">
                <div class="loading-dots">
                    <span class="loading-dot"></span>
                    <span class="loading-dot"></span>
                    <span class="loading-dot"></span>
                </div>
            </div>
        </div>

        <img src="/images/Gecko.png" alt="Gecko" id="loadingMascot" class="loading-mascot" />
        
        <button id="skipLoading" class="loading-skip" style="display: none;">
            ‡∫Ç‡ªâ‡∫≤‡∫° ‚Üí
        </button>

        <div id="loadingError" class="loading-error" style="display: none;">
            <p>‚ö†Ô∏è ‡∫°‡∫µ‡∫Ç‡ªç‡ªâ‡∫ú‡∫¥‡∫î‡∫û‡∫≤‡∫î‡ªÉ‡∫ô‡∫Å‡∫≤‡∫ô‡ªÇ‡∫´‡∫º‡∫î</p>
            <button onclick="location.reload()" style="padding: 0.5rem 1rem; margin-top: 1rem;">‡∫•‡∫≠‡∫á‡ªÉ‡ªù‡ªà</button>
        </div>
    </div>

    <!-- Main Game Content (hidden initially) -->
    <div id="main-content">
        <h1>Your Game Content Here</h1>
        <p>This content will appear after loading completes.</p>
    </div>

    <!-- Load preloader and controller -->
    <script src="/preloader.js"></script>
    <script>
        /**
         * Integration Example for Existing Pages
         * Shows how to add loading screen to gameplay.html, testing.html, etc.
         */
        
        // Loading Screen Controller (inline for immediate execution)
        class LoadingScreenController {
            constructor() {
                this.screen = document.getElementById('loadingScreen');
                this.progressFill = document.getElementById('progressFill');
                this.progressPercentage = document.getElementById('progressPercentage');
                this.progressMessage = document.getElementById('progressMessage');
                this.mascot = document.getElementById('loadingMascot');
                this.skipButton = document.getElementById('skipLoading');
                this.errorDiv = document.getElementById('loadingError');
                this.mainContent = document.getElementById('main-content');
                
                this.isVisible = true;
                this.canSkip = false;
                
                this.init();
            }

            init() {
                // Enable skip button after 3 seconds
                setTimeout(() => {
                    this.canSkip = true;
                    if (this.skipButton) {
                        this.skipButton.style.display = 'block';
                        this.skipButton.addEventListener('click', () => this.hide());
                    }
                }, 3000);

                // Add walking animation to mascot
                setTimeout(() => {
                    if (this.mascot) {
                        this.mascot.classList.add('walking');
                    }
                }, 2000);
            }

            updateProgress(data) {
                if (!this.isVisible) return;

                const { percentage, message } = data;
                
                if (this.progressFill) {
                    this.progressFill.style.width = `${percentage}%`;
                }
                
                if (this.progressPercentage) {
                    this.progressPercentage.textContent = `${percentage}%`;
                }
                
                if (this.progressMessage && message) {
                    this.progressMessage.innerHTML = message;
                }

                if (percentage >= 100) {
                    setTimeout(() => this.hide(), 500);
                }
            }

            showError(message) {
                if (this.errorDiv) {
                    this.errorDiv.style.display = 'block';
                    if (message) {
                        this.errorDiv.querySelector('p').textContent = message;
                    }
                }
            }

            hide() {
                if (!this.isVisible) return;
                
                this.isVisible = false;
                
                if (this.screen) {
                    this.screen.classList.add('hidden');
                    
                    setTimeout(() => {
                        if (this.screen && this.screen.parentNode) {
                            this.screen.parentNode.removeChild(this.screen);
                        }
                    }, 500);
                }
                
                // Show main content
                if (this.mainContent) {
                    this.mainContent.classList.add('ready');
                }
            }
        }

        // Initialize loading screen immediately
        const loadingScreen = new LoadingScreenController();

        // Main initialization function
        async function initializeApp() {
            // Create preloader
            const preloader = new GamePreloader();
            
            // Configure callbacks
            preloader.onProgress = (data) => {
                loadingScreen.updateProgress(data);
            };
            
            preloader.onComplete = async (data) => {
                console.log('‚úÖ Loading complete in', data.loadTime, 'ms');
                
                // Ensure minimum display time for smooth UX
                await preloader.ensureMinimumLoadTime(1500);
                
                // Hide loading screen and show content
                loadingScreen.hide();
                
                // Initialize your game/app
                initializeYourGame();
            };
            
            preloader.onError = (error) => {
                console.error('Loading error:', error);
                loadingScreen.showError('‡∫°‡∫µ‡∫Ç‡ªç‡ªâ‡∫ú‡∫¥‡∫î‡∫û‡∫≤‡∫î‡ªÉ‡∫ô‡∫Å‡∫≤‡∫ô‡ªÇ‡∫´‡∫º‡∫î‡ªÄ‡∫Å‡∫°');
            };
            
            // Start loading
            preloader.registerAssets();
            await preloader.load();
        }

        // Your existing game initialization
        function initializeYourGame() {
            console.log('üéÆ Game initialized!');
            // Your existing initialization code here
            // e.g., initializeGame(), setupEventListeners(), etc.
        }

        // Start loading when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
    </script>

    <!-- 
    ============================================
    INTEGRATION GUIDE FOR EXISTING PAGES
    ============================================
    
    To add the loading screen to existing pages like gameplay.html or testing.html:
    
    1. ADD TO HEAD SECTION:
    ```html
    <link rel="stylesheet" href="/loading-screen.css">
    <link rel="preload" href="/images/LaoTypo-logo-04.png" as="image">
    <link rel="preload" href="/images/Gecko.png" as="image">
    ```
    
    2. ADD LOADING SCREEN HTML after <body> tag:
    - Copy the #loadingScreen div from this file
    - Or include it via server-side includes/templating
    
    3. WRAP YOUR CONTENT:
    ```html
    <div id="main-content" style="display: none;">
        [Your existing game content]
    </div>
    ```
    
    4. MODIFY YOUR INITIALIZATION:
    
    BEFORE:
    ```javascript
    window.onload = async () => {
        initializeGame();
    };
    ```
    
    AFTER:
    ```javascript
    <script src="/preloader.js"></script>
    <script>
        // Add LoadingScreenController class (or import it)
        const loadingScreen = new LoadingScreenController();
        
        window.onload = async () => {
            const preloader = new GamePreloader();
            
            preloader.onProgress = (data) => {
                loadingScreen.updateProgress(data);
            };
            
            preloader.onComplete = async () => {
                await preloader.ensureMinimumLoadTime(1500);
                loadingScreen.hide();
                document.getElementById('main-content').style.display = 'block';
                initializeGame(); // Your existing init function
            };
            
            preloader.registerAssets();
            await preloader.load();
        };
    </script>
    ```
    
    5. OPTIMIZATION TIPS:
    - Use resource hints (preload, prefetch, preconnect)
    - Inline critical CSS to prevent FOUC
    - Defer non-critical scripts
    - Use async for independent scripts
    - Consider code splitting for large bundles
    
    6. CUSTOMIZATION OPTIONS:
    - Adjust minimum display time in ensureMinimumLoadTime()
    - Customize loading messages in Lao
    - Add sound effects for loading complete
    - Implement different loading animations
    - Add tips/hints during loading
    
    7. PERFORMANCE MONITORING:
    - Track loading times with analytics
    - Monitor failed asset loads
    - Set up error reporting
    - A/B test different loading approaches
    -->
</body>
</html>